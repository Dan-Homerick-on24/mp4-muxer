"use strict";var Mp4Muxer=(()=>{var b=Object.defineProperty;var B=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var k=Object.prototype.hasOwnProperty;var l=Math.pow;var H=(i,e)=>{for(var t in e)b(i,t,{get:e[t],enumerable:!0})},T=(i,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of V(e))!k.call(i,o)&&o!==t&&b(i,o,{get:()=>e[o],enumerable:!(s=B(e,o))||s.enumerable});return i};var z=i=>T(b({},"__esModule",{value:!0}),i);var v=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)};var r=(i,e,t)=>(v(i,e,"read from private field"),t?t.call(i):e.get(i)),f=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},d=(i,e,t,s)=>(v(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t);var I={};H(I,{ArrayBufferWriteTarget:()=>m,WriteTarget:()=>U,default:()=>L});var a,w,M=class{constructor(){f(this,a,void 0);f(this,w,void 0);d(this,a,new m),r(this,a).writeBox({type:"ftyp",contents:new Uint8Array([105,115,111,109,0,0,0,0,105,115,111,50,97,118,99,49,109,112,52,49])}),r(this,a).writeBox({type:"moov",children:[{type:"mvhd",contents:new Uint8Array([0,0,0,0,n(Math.floor(Date.now()/1e3)+l(2,31)),n(Math.floor(Date.now()/1e3)+l(2,31)),n(1e3),n(1e3),c(1),g(1),Array(10).fill(0),[1,0,0,0,1,0,0,0,1].flatMap(c),Array(24).fill(0),n(1)].flat())},{type:"trak",children:[{type:"tkhd",contents:new Uint8Array([0,0,0,3,n(Math.floor(Date.now()/1e3)+l(2,31)),n(Math.floor(Date.now()/1e3)+l(2,31)),n(1),n(0),n(1e3),Array(8).fill(0),0,0,0,0,g(1),0,0,[1,0,0,0,1,0,0,0,1].flatMap(c),c(512),c(512)].flat())},{type:"mdia",children:[{type:"mdhd",contents:new Uint8Array([0,0,0,0,n(Math.floor(Date.now()/1e3)+l(2,31)),n(Math.floor(Date.now()/1e3)+l(2,31)),n(1e3),n(1e3),0,0,0,0].flat())},{type:"hdlr",contents:new Uint8Array([0,0,0,0,n(0),D("vide"),Array(12).fill(0),D("Video track"),0].flat())},{type:"minf",children:[{type:"vmhd",contents:new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},{type:"stbl",children:[{type:"stsd",contents:new Uint8Array([0,0,0,0,n(1)].flat()),children:[{type:"avc1",contents:new Uint8Array([Array(6).fill(0),0,0,0,0,0,0,Array(12).fill(0),A(512),A(512),n(4718592),n(4718592),n(0),A(1),Array(32).fill(0),A(24),S(65535)].flat())}]}]}]}]}]}]}),d(this,w,{type:"mdat"}),r(this,a).writeBox(r(this,w))}addVideoChunk(e){let t=new Uint8Array(e.byteLength);e.copyTo(t),r(this,a).write(t)}finalize(){let e=r(this,a).offsets.get(r(this,w)),t=r(this,a).pos-e,s=r(this,a).pos;return r(this,a).pos=e,r(this,a).writeU32(t),r(this,a).pos=s,r(this,a).finalize()}};a=new WeakMap,w=new WeakMap;var A=i=>{let e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,i,!1),[...e]},S=i=>{let e=new Uint8Array(2);return new DataView(e.buffer).setInt16(0,i,!1),[...e]},n=i=>{let e=new Uint8Array(4);return new DataView(e.buffer).setUint32(0,i,!1),[...e]},g=i=>{let e=new Uint8Array(2),t=new DataView(e.buffer);return t.setUint8(0,i),t.setUint8(1,i<<8),[...e]},c=i=>{let e=new Uint8Array(4),t=new DataView(e.buffer);return t.setUint16(0,i,!1),t.setUint16(2,i<<16,!1),[...e]},D=i=>Array(i.length).fill(null).map((e,t)=>i.charCodeAt(t));var x,p,U=class{constructor(){this.pos=0;f(this,x,new Uint8Array(8));f(this,p,new DataView(r(this,x).buffer));this.offsets=new WeakMap}writeU32(e){r(this,p).setUint32(0,e,!1),this.write(r(this,x).subarray(0,4))}writeAscii(e){for(let t=0;t<e.length;t++)r(this,p).setUint8(t%8,e.charCodeAt(t)),t%8===7&&this.write(r(this,x));e.length%8!==0&&this.write(r(this,x).subarray(0,e.length%8))}writeBox(e){if(this.offsets.set(e,this.pos),e.contents&&!e.children)this.writeU32(e.contents.byteLength+8),this.writeAscii(e.type),this.write(e.contents);else{let t=this.pos;if(this.pos+=4,this.writeAscii(e.type),e.contents&&this.write(e.contents),e.children)for(let u of e.children)this.writeBox(u);let s=this.pos,o=s-t;this.pos=t,this.writeU32(o),this.pos=s}}};x=new WeakMap,p=new WeakMap;var h,y,m=class extends U{constructor(){super();f(this,h,new ArrayBuffer(l(2,16)));f(this,y,new Uint8Array(r(this,h)))}ensureSize(t){let s=r(this,h).byteLength;for(;s<t;)s*=2;if(s===r(this,h).byteLength)return;let o=new ArrayBuffer(s),u=new Uint8Array(o);u.set(r(this,y),0),d(this,h,o),d(this,y,u)}write(t){this.ensureSize(this.pos+t.byteLength),r(this,y).set(t,this.pos),this.pos+=t.byteLength}seek(t){this.pos=t}finalize(){return this.ensureSize(this.pos),r(this,h).slice(0,this.pos)}};h=new WeakMap,y=new WeakMap;var L=M;return z(I);})();
Mp4Muxer = Mp4Muxer.default;
if (typeof module === "object" && typeof module.exports === "object") module.exports = Mp4Muxer;
